---
title: "はじめに"
free: true
---

# この本について

![Gopher君](https://raw.githubusercontent.com/traefik/traefik/master/docs/content/assets/img/traefik.logo.png)
*https://github.com/traefik/traefik にいる公式キャラクター（Gopher 君？）。かわいい。*

本書では、コンテナ時代のリバースプロキシである[Traefik](https://traefik.io/)について記載しています。

リバースプロキシとしては[Nginx](https://www.nginx.co.jp/)が有名ですが、せっかくコンテナを使うのなら、Go 製のコンテナとかマイクロサービスに特化したモダンなリバースプロキシを使ってみたいと思い立ち採用しました。

ただ、これが使ってみると難しくて何度か挫折しました。。。難しいと感じた理由は後述しますが、使い方がわかるとめちゃめちゃ便利なので、興味があってこれから使ってみたいという方に是非読んでいただきたいです。

## 公式ドキュメント、難しくないですか？

Traefik における挫折要因の第 1 位だと思っているのですが、ドキュメントがやたら難しいです。

（公式ドキュメント）
https://doc.traefik.io/traefik/

ぱっと見、ドキュメントがきれいに整備されているように見えます。しかし、設定の方法がいくつかあるというのも原因かもしれませんが、情報が散乱しています。例えば、 HTTP/3 の設定はコードブロックで以下のように書いてあります。

```YAML
experimental:
  http3: true

entryPoints:
  name:
    http3: {}
```

> https://doc.traefik.io/traefik/routing/entrypoints/#http3

残念ながら HTTP/3 はこれだけでは使えません。一応、注意書きに"HTTP/3 uses UDP+TLS"と書いてあり、UDP が必要であることは明記されています。それならば、そのUDPの設定方法も記載をしてもらいたいところなのですが、Traefikのドキュメントには記載がありません。なぜならば、このセクションはHTTP/3の説明であり、エントリーポイント（というものがあります）の説明ページではないからです。

使い方をよく理解している人であれば、余計な記載が無く簡潔に書かれていて良いのかもしれませんが、UDP を設定するための設定例が無いためにイメージが湧きにくいかなと思います。


## 日本語の解説ページが少ない！

なんと Zenn での記事ゼロ！そんなことってある？スクラップを書かれていた方はいらっしゃいました。そんなにマイナーなソフトではないはずですが、日本語での情報が結構少ないです。要所要所を掻い摘んで説明されているサイトはありますが、網羅的に記載しているサイトはほとんどないかもしれません。さらに Traefik は色々な設定方法があるために様々な情報を集約して設定方法を統一させないとうまく動きません。

本書では、いろいろな設定方法はあるものの、個人的に設定しやすかった方法で揃えて記載したいと思います。

## 想定する読者
以下のような層を想定しています。

- 自宅サーバでセルフホスティングな人
- Docker+Traefik に興味がある人
- 公式ドキュメントを読み疲れた人

おそらくTraefikを使ってみたいな～と考えている方は、自宅サーバでセルフホスティングしている人が多いと思います。というのも、パブリッククラウド等を使用している人はTraefikの代わりになるものが用意されているからです。

また、今回はDockerとの組み合わせを解説しています。Kubernetes等のコンテナオーケストレーターご利用のドチャクソいけてる陽キャエンジニアの方すみません。

公式ドキュメントが難しく感じるところはあるかもしれませんが、公式ドキュメントが全てなので、慣れてきたら公式ドキュメントの参照をお勧めします。


## 使用する環境とソフトウェア

バージョンは異なっていても大体動くと思います。ただ、Traefik は v1 と v2 だと全く別物なのでバージョンは 2.X.0 を使用してください。

また、HTTPS の項目では Amazon Web Services（AWS）の Route 53 を使用しています。筆者は DNS の管理に Route53 を使用しているため、Route53 を使って説明をします。

| ソフトウェアとか    | バージョン    | 用途                            |
|-------------|----------|---------------------------------|
| Ubuntu      | 21.10    | OS です。Docker が動けばなんでも大丈夫です。 |
| Docker      | 20.10.12 | コンテナを扱うので Docker を使用します。     |
| Traefik     | 2.8.1    | 今回の主役です。                    |
| AWS Route53 | -        | DNS です。これも他のサービスでも大丈夫です。    |
| Nextcloud   | 24.0.2   | セルスホスティングできるオンラインストレージです。       |
| Prometheus  | 2.37.0   | メトリクスを収集する監視ソフトです。          |

:::message
筆者の設定方法は一例です。もっとイケてる方法があるかもしれません。また、何か間違ってることを書いているかもしれませんので、その点ご了承ください。何か修正点・改善案あれば PR 等でお知らせください。
:::

:::message alert
あまりセキュリティを考慮していません。運用上問題がある可能性がありますので、インターネットに公開する際は十分注意してください。
:::